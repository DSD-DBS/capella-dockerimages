#!/bin/sh
# SPDX-FileCopyrightText: Copyright DB Netz AG and the capella-collab-manager contributors
# SPDX-License-Identifier: Apache-2.0

# Autostart script for OpenBox

export PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
export DISPLAY=:99

nitrogen --restore &

if [ "$AUTOSTART_CAPELLA" = "1" ];
then
    if [ "$RESTART_CAPELLA" = "1" ];
    then
        # Run capella in a loop:
        ( while true; do /opt/capella/capella -data /workspace > /var/log/capella.stdout.log 2> /var/log/capella.stderr.log; sleep 1; done ) &
    else
        /opt/capella/capella -data /workspace > /var/log/capella.stdout.log 2> /var/log/capella.stderr.log &
    fi
fi
